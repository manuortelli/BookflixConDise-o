{"ast":null,"code":"var _jsxFileName = \"/home/manuel/git/BookflixOficialDonna/bf/front-end/src/components/VistaSuscriptor/Libros/DetalleLibro.js\";\nimport React, { Component, useState } from \"react\";\nimport axios from \"axios\";\nimport DatosLibro from \"./DatosLibro\";\nimport { Link } from \"react-router-dom\";\nimport ListarCapitulos from \"./ListarCapitulos\";\nimport { Button } from \"react-bootstrap\";\nimport MostrarTrailersAsociados from \"../Trailers/MostrarTrailersAsociados\";\nimport HeartCheckbox from 'react-heart-checkbox';\nconst perfiles = \"http://localhost:4000/api/perfiles/\";\nconst editoriales = \"http://localhost:4000/api/editoriales/\";\nconst generos = \"http://localhost:4000/api/generos/\";\nconst autores = \"http://localhost:4000/api/autores/\";\nconst Trailers = \"http://localhost:4000/api/trailers\";\nconst portada = \"http://localhost:4000/uploads/\";\nconst me = \"http://localhost:4000/api/libros/me\";\nconst terminado = \"http://localhost:4000/api/libros/terminado\";\nconst capi = \"http://localhost:4000/api/libros/misCapitulos\";\nexport default class DetalleLibrosAdmin extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getNombres = async () => {\n      //traigo el autor actual\n      await axios.post(autores + \"me\", {\n        id: this.state.libro.autor\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        console.log(res.data);\n        this.setState({\n          autor: res.data\n        });\n      }).catch(err => {\n        console.log(err);\n      }); //traigo el genero actual\n\n      await axios.post(generos + \"me\", {\n        id: this.state.libro.genero\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        console.log(res.data);\n        this.setState({\n          genero: res.data\n        });\n      }).catch(err => {\n        console.log(err);\n      }); //traigo la editorial actual\n\n      await axios.post(editoriales + \"me\", {\n        id: this.state.libro.editorial\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        this.setState({\n          editorial: res.data\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.getTrailer = async () => {\n      console.log(this.state.libro.trailer);\n      console.log(this.state.libro.trailer != null || this.state.libro.trailer != '');\n\n      if (this.state.libro.trailer != null) {\n        this.state.hayTrailer = true;\n        /* await axios\n        .post(\n         Trailers + \"me\",\n         { id: this.state.libro.trailer },\n         { headers: { xaccess: this.state.token } }\n        )\n        .then((res) => {\n         \n         this.setState({\n           trailer: res.data,\n           hayTrailer:true,\n         });\n        })\n        .catch((err) => {\n         console.log(err.response.data.msg);\n        });\n        */\n      }\n    };\n\n    this.getTermine = async () => {\n      await axios.post(terminado, {\n        id: this.state.id\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        if (res.data.finalizado == true) {\n          this.setState({\n            botonTermine: true\n          });\n        }\n      });\n    };\n\n    this.getDatos = async () => {\n      await axios.post(me, {\n        id: this.state.id\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        this.setState({\n          libro: res.data,\n          capitulos: res.data.capitulos\n        });\n        this.getCapitulos();\n        this.getNombres();\n        this.HayCapitulos();\n        this.getTrailer();\n        this.getTermine();\n        this.tieneLike();\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.filtrarCapitulos = capi => {\n      var validos = [];\n      const hoy = JSON.stringify(new Date().getDate());\n      const mes = JSON.stringify(new Date().getMonth() + 1);\n      const año = JSON.stringify(new Date().getFullYear());\n      const hoyEntera = JSON.stringify(new Date());\n\n      if (capi != []) {\n        capi.map(cap => {\n          const lanzaHoy = JSON.stringify(new Date(cap.lanzamiento).getDate());\n          const lanzaMes = JSON.stringify(new Date(cap.lanzamiento).getMonth() + 1);\n          const lanzaAño = JSON.stringify(new Date(cap.lanzamiento).getFullYear());\n          const lanzaEntera = JSON.stringify(new Date(capi.lanzamiento));\n\n          if (hoy == lanzaHoy & mes == lanzaMes & año == lanzaAño || lanzaEntera > hoyEntera) {\n            if (cap.vencimiento) {\n              const venciHoy = JSON.stringify(new Date(cap.lanzamiento).getDate());\n              const venciMes = JSON.stringify(new Date(cap.lanzamiento).getMonth() + 1);\n              const venciAño = JSON.stringify(new Date(cap.lanzamiento).getFullYear());\n              const venciEntera = JSON.stringify(new Date(cap.vencimiento));\n\n              if (venciHoy == hoy & venciMes == mes & venciAño == año || venciEntera > hoyEntera) {\n                validos.push(cap);\n              }\n            } else {\n              validos.push(cap);\n            }\n          }\n        });\n        this.setState({\n          capitulosActivos: validos\n        });\n      }\n\n      console.log(\"CAPITULOS DESPUES DE FILTRARLOS\", this.state.capitulosActivos);\n    };\n\n    this.getCapitulos = async () => {\n      await axios.post(capi, {\n        id: this.props.match.params.id\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        this.setState({\n          capi: res.data\n        });\n        this.filtrarCapitulos(res.data);\n      }).catch(err => {\n        console.log(err);\n        alert(JSON.stringify(err.response.data.msg));\n      });\n    };\n\n    this.tieneLike = () => {\n      this.state.miPerfil.likesLibros.forEach(element => {\n        console.log(\"Esta haciendo el for each\");\n\n        if (element == this.props.match.params.id) {\n          this.setState({\n            botonlike: true\n          });\n        }\n      });\n    };\n\n    this.HayCapitulos = () => {\n      if (this.state.capitulos != \"\") {\n        this.state.bottonCap = true;\n      }\n    };\n\n    this.leerLibro = async () => {\n      if (!this.state.bottonCap) {\n        await axios.post(perfiles + \"visitadoLibro\", {\n          id: sessionStorage.getItem(\"perfilID\"),\n          libroId: this.state.id\n        }, {\n          headers: {\n            xaccess: this.state.token\n          }\n        }).then(res => {\n          console.log(res.data);\n        }).catch(err => {\n          console.log(err);\n          alert(JSON.stringify(err.response.data.msg));\n        });\n      }\n    };\n\n    this.fechaExpiracion = () => {\n      if (!this.props.libro.fechaExpiracion) {\n        return /*#__PURE__*/React.createElement(\"h6\", {\n          className: \"card-subtitle mb-2 text-muted\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 9\n          }\n        }, \"Fecha de expiraci\\xF3n: \", this.state.libro.expiracion);\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 14\n          }\n        });\n      }\n    };\n\n    this.termineLibro = async () => {\n      await axios.post(perfiles + \"termineLibro\", {\n        id: sessionStorage.getItem(\"perfilID\"),\n        libroId: this.state.libro._id\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        alert(res.data.msg);\n      }).catch(err => {\n        alert(err.response.data.msg);\n      });\n    };\n\n    this.onClickLike = async () => {\n      console.log(\"Aca presta atención\", this.state.id);\n      this.setState({\n        botonlike: !this.state.botonlike\n      });\n      await axios.post(perfiles + 'likeLibro', {\n        id: this.state.miPerfil._id,\n        idLibro: this.state.id\n      }, {\n        headers: {\n          xaccess: this.state.token\n        }\n      }).then(res => {\n        alert(res.data.msg);\n      }).catch(err => {\n        alert(err.response.data.msg);\n      });\n    };\n\n    this.state = {\n      id: this.props.match.params.id,\n      token: sessionStorage.getItem(\"token\"),\n      miPerfil: JSON.parse(sessionStorage.getItem(\"perfilUser\")),\n      libro: \"\",\n      capitulos: \"\",\n      editorial: \"\",\n      genero: \"\",\n      autor: \"\",\n      bottonCap: false,\n      mostrarCapitulos: false,\n      trailer: null,\n      hayTrailer: false,\n      capi: [],\n      capitulosActivos: [],\n      botonTermine: false,\n      botonlike: false,\n      verReseñas: false,\n      reseñas: [{\n        comentario: 'muy buen libro',\n        ranting: 5,\n        spoiler: false,\n        autor: {\n          nombre: 'Macri'\n        }\n      }, {\n        comentario: 'lo recomiendo',\n        ranting: 4,\n        spoiler: true,\n        autor: {\n          nombre: 'Alberto toto'\n        }\n      }, {\n        comentario: 'malisimooo',\n        ranting: 1,\n        spoiler: false,\n        autor: {\n          nombre: 'Anonimus'\n        }\n      }, {\n        comentario: 'al final muere Thanos',\n        ranting: 3,\n        spoiler: true,\n        autor: {\n          nombre: 'Messi'\n        }\n      }]\n    };\n    this.fechaExpiracion = this.fechaExpiracion.bind(this);\n    this.mostrarCapitulos = this.mostrarCapitulos.bind(this);\n  }\n\n  mostrarCapitulos() {\n    this.setState({\n      mostrarCapitulos: !this.state.mostrarCapitulos\n    });\n    console.log(this.state.mostrarCapitulos);\n  }\n\n  componentDidMount() {\n    this.getDatos();\n    this.HayCapitulos();\n    console.log(\"esto\", this.state.miPerfil.likesLibros);\n  }\n\n  render() {\n    const show = this.state.bottonCap;\n    const termineL = this.state.botonTermine;\n    const hayTrailer = this.state.hayTrailer;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"cardDetalleLibro\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"card-title text-light \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 15\n      }\n    }, \" \", this.state.libro.titulo), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"botonlike\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(HeartCheckbox, {\n      checked: this.state.botonlike,\n      onClick: this.onClickLike,\n      tabindex: \"0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"img\", {\n      src: portada + `${this.state.libro.portada}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bodyDetalleLibro\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"card-subtitle mb-2 text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 17\n      }\n    }, \"Editorial: \", \" \" + this.state.editorial.nombre), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"card-subtitle mb-2 text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 17\n      }\n    }, \"Autor:\", \" \", \" \" + this.state.autor.nombre + \" \" + this.state.autor.apellido), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"card-subtitle mb-2 text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 17\n      }\n    }, \"Genero: \", \" \" + this.state.genero.nombre), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"card-subtitle mb-2 text-light\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 17\n      }\n    }, \"ISBN: \", \" \" + this.state.libro.isbn)), termineL ? /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      height: \"200px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-danger\",\n      onClick: this.termineLibro,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 21\n      }\n    }, \"Termine\"))) : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 19\n      }\n    }), hayTrailer ? /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-outline-danger itemBoton\",\n      to: '/suscriptor/trailers/detalle/' + this.state.libro.trailer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 17\n      }\n    }, \"Ver Trailer\") : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 20\n      }\n    }, \" \"), /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-outline-danger itemBoton\",\n      to: '/suscriptor/libros/reseña/' + this.state.libro._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 15\n      }\n    }, \"Agregar Rese\\xF1a\")), show ? /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ListarCapitulos, {\n      capitulos: this.state.capitulosActivos,\n      libroId: this.state.libro._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 17\n      }\n    })) : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btn-leerlibro\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      onClick: this.leerLibro,\n      className: \"btn btn-outline-danger itemBoton\",\n      to: \"/suscriptor/libros/leer/\" + this.state.libro.archivo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 21\n      }\n    }, \" \", \"Leer Libro\", \" \"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btn-leerlibro\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      onClick: this.leerLibro,\n      className: \"btn btn-outline-danger itemBoton\",\n      to: \"/suscriptor/reseñas/\" + this.state.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 21\n      }\n    }, \" \", \"Ver Rese\\xF1as\", \" \")))));\n  }\n\n}","map":{"version":3,"sources":["/home/manuel/git/BookflixOficialDonna/bf/front-end/src/components/VistaSuscriptor/Libros/DetalleLibro.js"],"names":["React","Component","useState","axios","DatosLibro","Link","ListarCapitulos","Button","MostrarTrailersAsociados","HeartCheckbox","perfiles","editoriales","generos","autores","Trailers","portada","me","terminado","capi","DetalleLibrosAdmin","constructor","props","getNombres","post","id","state","libro","autor","headers","xaccess","token","then","res","console","log","data","setState","catch","err","genero","editorial","getTrailer","trailer","hayTrailer","getTermine","finalizado","botonTermine","getDatos","capitulos","getCapitulos","HayCapitulos","tieneLike","filtrarCapitulos","validos","hoy","JSON","stringify","Date","getDate","mes","getMonth","año","getFullYear","hoyEntera","map","cap","lanzaHoy","lanzamiento","lanzaMes","lanzaAño","lanzaEntera","vencimiento","venciHoy","venciMes","venciAño","venciEntera","push","capitulosActivos","match","params","alert","response","msg","miPerfil","likesLibros","forEach","element","botonlike","bottonCap","leerLibro","sessionStorage","getItem","libroId","fechaExpiracion","expiracion","termineLibro","_id","onClickLike","idLibro","parse","mostrarCapitulos","verReseñas","reseñas","comentario","ranting","spoiler","nombre","bind","componentDidMount","render","show","termineL","titulo","apellido","isbn","archivo"],"mappings":"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","sourcesContent":["import React, { Component, useState } from \"react\";\nimport axios from \"axios\";\nimport DatosLibro from \"./DatosLibro\";\nimport { Link } from \"react-router-dom\";\nimport ListarCapitulos from \"./ListarCapitulos\";\nimport { Button } from \"react-bootstrap\";\nimport MostrarTrailersAsociados from \"../Trailers/MostrarTrailersAsociados\";\nimport HeartCheckbox from 'react-heart-checkbox';\n\nconst perfiles = \"http://localhost:4000/api/perfiles/\";\nconst editoriales = \"http://localhost:4000/api/editoriales/\";\nconst generos = \"http://localhost:4000/api/generos/\";\nconst autores = \"http://localhost:4000/api/autores/\";\nconst Trailers = \"http://localhost:4000/api/trailers\";\n\nconst portada = \"http://localhost:4000/uploads/\";\nconst me = \"http://localhost:4000/api/libros/me\";\nconst terminado = \"http://localhost:4000/api/libros/terminado\";\nconst capi = \"http://localhost:4000/api/libros/misCapitulos\";\n\n\n\nexport default class DetalleLibrosAdmin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      id: this.props.match.params.id,\n      token: sessionStorage.getItem(\"token\"),\n      miPerfil: JSON.parse(sessionStorage.getItem(\"perfilUser\")),\n      libro: \"\",\n      capitulos: \"\",\n      editorial: \"\",\n      genero: \"\",\n      autor: \"\",\n      bottonCap: false,\n      mostrarCapitulos: false,\n      trailer: null,\n      hayTrailer: false,\n      capi: [],\n      capitulosActivos: [],\n      botonTermine: false,\n      botonlike: false,\n      verReseñas:false,\n\n      reseñas:[{\n        comentario:'muy buen libro',\n        ranting:5,\n        spoiler:false,\n        autor:{nombre: 'Macri' }\n    },{\n        comentario:'lo recomiendo',\n        ranting:4,\n        spoiler:true,\n        autor:{nombre: 'Alberto toto' }\n    },{\n        comentario:'malisimooo',\n        ranting:1,\n        spoiler:false,\n        autor:{nombre: 'Anonimus' }\n    },\n    {\n        comentario:'al final muere Thanos',\n        ranting:3,\n        spoiler:true,\n        autor:{nombre: 'Messi' }\n    }\n\n\n],\n    };\n    this.fechaExpiracion = this.fechaExpiracion.bind(this);\n    this.mostrarCapitulos = this.mostrarCapitulos.bind(this);\n  }\n\n  getNombres = async () => {\n    //traigo el autor actual\n    await axios\n      .post(\n        autores + \"me\",\n        { id: this.state.libro.autor },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        console.log(res.data);\n        this.setState({\n          autor: res.data,\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n\n    //traigo el genero actual\n    await axios\n      .post(\n        generos + \"me\",\n        { id: this.state.libro.genero },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        console.log(res.data);\n        this.setState({\n          genero: res.data,\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n\n    //traigo la editorial actual\n    await axios\n      .post(\n        editoriales + \"me\",\n        { id: this.state.libro.editorial },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        this.setState({\n          editorial: res.data,\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  getTrailer = async () => {\n    console.log(this.state.libro.trailer)\n    console.log((this.state.libro.trailer != null) || (this.state.libro.trailer != ''))\n    if ((this.state.libro.trailer != null)) {\n\n      this.state.hayTrailer = true\n\n      /* await axios\n     .post(\n       Trailers + \"me\",\n       { id: this.state.libro.trailer },\n       { headers: { xaccess: this.state.token } }\n     )\n     .then((res) => {\n       \n       this.setState({\n         trailer: res.data,\n         hayTrailer:true,\n       });\n     })\n     .catch((err) => {\n       console.log(err.response.data.msg);\n     });\n   */\n    }\n  };\n\n  getTermine = async () => {\n    await axios\n      .post(\n        terminado,\n        {\n          id: this.state.id,\n        },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        if (res.data.finalizado == true) {\n        this.setState({botonTermine:true})\n        }\n      });\n  };\n\n  getDatos = async () => {\n    await axios\n      .post(\n        me,\n        { id: this.state.id },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        this.setState({\n          libro: res.data,\n          capitulos: res.data.capitulos,\n        });\n        this.getCapitulos();\n        this.getNombres();\n        this.HayCapitulos();\n        this.getTrailer();\n        this.getTermine();\n        this.tieneLike();\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  filtrarCapitulos = (capi) => {\n    var validos = [];\n\n    const hoy = JSON.stringify(new Date().getDate());\n    const mes = JSON.stringify(new Date().getMonth() + 1);\n    const año = JSON.stringify(new Date().getFullYear());\n    const hoyEntera = JSON.stringify(new Date());\n\n    if (capi != []) {\n      capi.map((cap) => {\n        const lanzaHoy = JSON.stringify(new Date(cap.lanzamiento).getDate());\n        const lanzaMes = JSON.stringify(\n          new Date(cap.lanzamiento).getMonth() + 1\n        );\n        const lanzaAño = JSON.stringify(\n          new Date(cap.lanzamiento).getFullYear()\n        );\n        const lanzaEntera = JSON.stringify(new Date(capi.lanzamiento));\n        if (\n          (hoy == lanzaHoy) & (mes == lanzaMes) & (año == lanzaAño) ||\n          lanzaEntera > hoyEntera\n        ) {\n          if (cap.vencimiento) {\n            const venciHoy = JSON.stringify(\n              new Date(cap.lanzamiento).getDate()\n            );\n            const venciMes = JSON.stringify(\n              new Date(cap.lanzamiento).getMonth() + 1\n            );\n            const venciAño = JSON.stringify(\n              new Date(cap.lanzamiento).getFullYear()\n            );\n            const venciEntera = JSON.stringify(new Date(cap.vencimiento));\n\n            if (\n              (venciHoy == hoy) & (venciMes == mes) & (venciAño == año) ||\n              venciEntera > hoyEntera\n            ) {\n              validos.push(cap);\n            }\n          } else {\n            validos.push(cap);\n          }\n        }\n      });\n      this.setState({\n        capitulosActivos: validos,\n      });\n    }\n    console.log(\"CAPITULOS DESPUES DE FILTRARLOS\", this.state.capitulosActivos);\n  };\n\n  getCapitulos = async () => {\n    await axios\n      .post(\n        capi,\n        { id: this.props.match.params.id },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        this.setState({\n          capi: res.data,\n        });\n\n        this.filtrarCapitulos(res.data);\n      })\n      .catch((err) => {\n        console.log(err);\n        alert(JSON.stringify(err.response.data.msg));\n      });\n  };\n\n  tieneLike = () => {\n    this.state.miPerfil.likesLibros.forEach(element => {\n      console.log(\"Esta haciendo el for each\")\n      if (element == this.props.match.params.id) {\n        this.setState({ botonlike: true })\n      }\n    });\n  }\n\n  HayCapitulos = () => {\n    if (this.state.capitulos != \"\") {\n      this.state.bottonCap = true;\n    }\n  };\n\n  leerLibro = async () => {\n    if (!this.state.bottonCap) {\n      await axios\n        .post(\n          perfiles + \"visitadoLibro\",\n          { id: sessionStorage.getItem(\"perfilID\"), libroId: this.state.id },\n          { headers: { xaccess: this.state.token } }\n        )\n        .then((res) => {\n          console.log(res.data);\n        })\n        .catch((err) => {\n          console.log(err);\n          alert(JSON.stringify(err.response.data.msg));\n        });\n    }\n  };\n\n\n  fechaExpiracion = () => {\n    if (!this.props.libro.fechaExpiracion) {\n      return (\n        <h6 className=\"card-subtitle mb-2 text-muted\">\n          Fecha de expiración: {this.state.libro.expiracion}\n        </h6>\n      );\n    } else {\n      return <div />;\n    }\n  };\n\n  mostrarCapitulos() {\n    this.setState({\n      mostrarCapitulos: !this.state.mostrarCapitulos,\n    });\n    console.log(this.state.mostrarCapitulos);\n  }\n\n  termineLibro = async () => {\n    await axios\n      .post(\n        perfiles + \"termineLibro\",\n        {\n          id: sessionStorage.getItem(\"perfilID\"),\n          libroId: this.state.libro._id,\n        },\n        { headers: { xaccess: this.state.token } }\n      )\n      .then((res) => {\n        alert(res.data.msg);\n      })\n      .catch((err) => {\n        alert(err.response.data.msg);\n      });\n  };\n\n  onClickLike = async () => {\n\n    console.log(\"Aca presta atención\", this.state.id)\n    this.setState({ botonlike: !this.state.botonlike });\n    await axios.post(\n      perfiles + 'likeLibro',\n      {\n        id: this.state.miPerfil._id,\n        idLibro: this.state.id,\n      },\n      { headers: { xaccess: this.state.token } }\n    )\n      .then((res) => {\n        alert(res.data.msg);\n      })\n      .catch((err) => {\n        alert(err.response.data.msg);\n      });\n\n\n  }\n\n  componentDidMount() {\n    this.getDatos();\n    this.HayCapitulos();\n    console.log(\"esto\",this.state.miPerfil.likesLibros)\n  }\n\n\n\n  render() {\n    \n    const show = this.state.bottonCap;\n    const termineL = this.state.botonTermine;\n    const hayTrailer = this.state.hayTrailer;\n\n    return (\n      <div>\n        <div className=\"container\">\n          <div className=\"cardDetalleLibro\">\n            <div className=\"card-body\">\n              <h3 className=\"card-title text-light \">\n                {\" \"}\n                {this.state.libro.titulo}\n              </h3>\n              <div className=\"botonlike\">\n                <HeartCheckbox checked={this.state.botonlike} onClick={this.onClickLike} tabindex=\"0\" />\n              </div>\n              <img src={portada + `${this.state.libro.portada}`} />\n\n\n\n\n              <br></br>\n\n\n              <div className=\"bodyDetalleLibro\">\n\n                <h6 className=\"card-subtitle mb-2 text-light\">\n                  Editorial: {\" \" + this.state.editorial.nombre}\n                </h6>\n                <p></p>\n                <h6 className=\"card-subtitle mb-2 text-light\">\n                  Autor:{\" \"}\n                  {\" \" +\n                    this.state.autor.nombre +\n                    \" \" +\n                    this.state.autor.apellido}\n                </h6>\n                <p></p>\n                <h6 className=\"card-subtitle mb-2 text-light\">\n                  Genero: {\" \" + this.state.genero.nombre}\n                </h6>\n                <p></p>\n                <h6 className=\"card-subtitle mb-2 text-light\">\n                  ISBN: {\" \" + this.state.libro.isbn}\n                </h6>\n              </div>\n              {termineL ? (\n                <React.Fragment>\n                  <div height=\"200px\">\n                    <button\n                      className=\"btn btn-outline-danger\"\n                      onClick={this.termineLibro}\n                    >\n                      Termine\n                    </button>\n                  </div>\n\n                </React.Fragment>\n              ) : (\n                  <React.Fragment></React.Fragment>\n                )}\n\n              {hayTrailer ? (\n                <Link className='btn btn-outline-danger itemBoton' to={'/suscriptor/trailers/detalle/' + this.state.libro.trailer}  >\n                  Ver Trailer\n                </Link>\n              ) : (<React.Fragment> </React.Fragment>)}\n\n              <Link className=\"btn btn-outline-danger itemBoton\" to={'/suscriptor/libros/reseña/' + this.state.libro._id}>\n                Agregar Reseña\n              </Link>\n            </div>\n            {show ? (\n              <React.Fragment>\n\n                <ListarCapitulos\n                  capitulos={this.state.capitulosActivos}\n                  libroId={this.state.libro._id}\n                ></ListarCapitulos>\n\n              </React.Fragment>\n            ) : (\n                <React.Fragment>\n\n                  <div className=\"btn-leerlibro\">\n                    <Link\n                      onClick={this.leerLibro}\n                      className=\"btn btn-outline-danger itemBoton\"\n                      to={\"/suscriptor/libros/leer/\" + this.state.libro.archivo}\n                    >\n                      {\" \"}\n                    Leer Libro{\" \"}\n                    </Link>\n                  </div>\n\n                </React.Fragment>\n              )}\n              <div className=\"btn-leerlibro\">\n                    <Link\n                      onClick={this.leerLibro}\n                      className=\"btn btn-outline-danger itemBoton\"\n                      to={\"/suscriptor/reseñas/\" + this.state.id}\n                    >\n                      {\" \"}\n                    Ver Reseñas{\" \"}\n                    </Link>\n                  </div>\n\n\n          </div>\n        </div>\n\n\n\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}